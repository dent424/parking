<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel Selection Experiment</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; }
        #hotel-list { list-style-type: none; padding: 0; }
        #hotel-list li { margin-bottom: 10px; }
        #hotel-details { display: none; }
        button { margin-top: 20px; }
        .more-details { margin-left: 10px; color: blue; text-decoration: underline; cursor: pointer; }
        .hotel-radio { margin-right: 10px; }
    </style>
</head>
<body>
    <div id="main-page">
        <h1>Select a Hotel</h1>
        <ul id="hotel-list"></ul>
        <button id="confirm-selection" style="display: none;">Confirm Selection</button>
    </div>
    
    <div id="hotel-details">
        <h2 id="hotel-name"></h2>
        <p id="hotel-description"></p>
        <button id="back-to-list">Back to List</button>
    </div>

    <script>
        const hotels = [
            { name: "Sunset Beach Resort", description: "Luxurious beachfront property with stunning ocean views." },
            { name: "Mountain View Lodge", description: "Cozy retreat nestled in the beautiful mountains." },
            { name: "City Center Hotel", description: "Modern hotel in the heart of downtown, close to all attractions." },
        ];

        let selectedHotel = null;

        // Capture the returnUrl from the URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const returnUrl = urlParams.get('returnUrl');

        function displayHotels() {
            const hotelList = document.getElementById('hotel-list');
            hotels.forEach((hotel, index) => {
                const li = document.createElement('li');

                // Add radio button for hotel selection
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'hotel';
                radio.value = index;
                radio.id = `hotel-${index}`;
                radio.className = 'hotel-radio';
                radio.onchange = () => selectHotel(index);
                
                const label = document.createElement('label');
                label.htmlFor = `hotel-${index}`;
                label.textContent = hotel.name;

                // Add "More Details" link
                const moreDetailsLink = document.createElement('a');
                moreDetailsLink.textContent = "More Details";
                moreDetailsLink.className = "more-details";
                moreDetailsLink.href = "#";
                moreDetailsLink.onclick = (e) => {
                    e.preventDefault();
                    showHotelDetails(index);
                };

                li.appendChild(radio);
                li.appendChild(label);
                li.appendChild(moreDetailsLink);
                hotelList.appendChild(li);
            });
        }

        function selectHotel(index) {
            selectedHotel = hotels[index];
            document.getElementById('confirm-selection').style.display = 'block';
        }

        function showHotelDetails(index) {
            selectedHotel = hotels[index];
            document.getElementById('hotel-name').textContent = selectedHotel.name;
            document.getElementById('hotel-description').textContent = selectedHotel.description;
            document.getElementById('main-page').style.display = 'none';
            document.getElementById('hotel-details').style.display = 'block';
        }

        document.getElementById('back-to-list').onclick = () => {
            document.getElementById('main-page').style.display = 'block';
            document.getElementById('hotel-details').style.display = 'none';
        };

        document.getElementById('confirm-selection').onclick = () => {
            if (selectedHotel) {
                // Redirect back to Qualtrics with the selected hotel included as a query parameter
                if (returnUrl) {
                    const redirectTo = `${returnUrl}&selectedHotel=${encodeURIComponent(selectedHotel.name)}`;
                    window.location.href = redirectTo;
                } else {
                    alert('Return URL not found. Please try again.');
                }
            } else {
                alert('Please select a hotel before confirming.');
            }
        };

        displayHotels();
    </script>
</body>
</html>
